import{d as N,a as p,r as I,o as S,c as U,w as a,j as T,b as o,e as h,u as d,f as B,q as P,t as q,k as $,s as j,F as G,v as L}from"./index-3dfffe59.js";import{E as M,a as A,v as O}from"./el-select-4ffd42ee.js";import{E as H}from"./el-input-7a12cdcb.js";import"./el-tag-252c5fac.js";import{E as J,a as K}from"./el-table-column-0b3b7ff5.js";import"./el-checkbox-40223007.js";import{E as Q}from"./el-popover-2931320e.js";import{a as g}from"./myaxios-3322f827.js";import{E as W}from"./el-overlay-a2f6c936.js";import{E as X,a as Y}from"./el-form-item-edabd295.js";import"./index-330ef0c5.js";import"./scroll-05d3369a.js";const Z={class:"dialog-footer"},ee=N({__name:"dialogGoodsConfig",props:["type","id","reload","configType"],setup(D,{expose:s}){const i=D,u=p(!1),_=p();let e=I({name:"",link:"",id:"",sort:""}),C=new FormData;const k=I({name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],link:[{required:!1,message:"请输入图片url地址",trigger:"blur"}],id:[{required:!0,message:"请输入商品编号",trigger:"blur"}],sort:[{required:!0,message:"请输入排序号",trigger:"blur"}]});function y(){u.value=!1}function E(){u.value=!0,i.type==="add"?(e.name="",e.id="",e.link="",e.sort=""):g.get(`/indexConfigs/${i.id}`).then(c=>{console.log(c),e.name=c.configName,e.id=c.goodsId,e.link=c.redirectUrl,e.sort=c.configRank})}function f(){u.value=!1,console.log(C.get("file")),i.type==="add"?g.post("/indexConfigs",{configType:i.configType||3,configName:e.name,redirectUrl:e.link,goodsId:e.id,configRank:e.sort}).then(()=>{console.log("添加成功"),i.reload()}):g.put("/indexConfigs",{configId:i.id,configType:i.configType||3,configName:e.name,redirectUrl:e.link,goodsId:e.id,configRank:e.sort}).then(()=>{console.log("编辑成功"),i.reload&&i.reload()})}return s({open:E,close:y}),(c,r)=>{const b=H,v=X,x=Y,l=B,t=W;return S(),U(t,{ref_key:"dialogEle",ref:_,modelValue:u.value,"onUpdate:modelValue":r[4]||(r[4]=n=>u.value=n),title:i.type=="add"?"新增商品":"修改商品",width:"30%","show-close":!1,"destroy-on-close":""},{footer:a(()=>[T("span",Z,[o(l,{type:"primary",onClick:y},{default:a(()=>[h("关闭")]),_:1}),o(l,{type:"primary",onClick:f},{default:a(()=>[h("确认")]),_:1})])]),default:a(()=>[o(x,{ref:"formRef","label-position":"left",model:d(e),"label-width":"100px",class:"demo-ruleForm",rules:k},{default:a(()=>[o(v,{"label-width":"110px",label:"商品名称",prop:"name"},{default:a(()=>[o(b,{modelValue:d(e).name,"onUpdate:modelValue":r[0]||(r[0]=n=>d(e).name=n),placeholder:"请输入图片url地址"},null,8,["modelValue"])]),_:1}),o(v,{"label-width":"110px",label:"跳转链接",prop:"link"},{default:a(()=>[o(b,{modelValue:d(e).link,"onUpdate:modelValue":r[1]||(r[1]=n=>d(e).link=n),placeholder:"请输入图片url地址"},null,8,["modelValue"])]),_:1}),o(v,{"label-width":"110px",label:"商品编号",prop:"id"},{default:a(()=>[o(b,{type:"index",modelValue:d(e).id,"onUpdate:modelValue":r[2]||(r[2]=n=>d(e).id=n)},null,8,["modelValue"])]),_:1}),o(v,{"label-width":"110px",label:"排序值",prop:"sort"},{default:a(()=>[o(b,{type:"number",modelValue:d(e).sort,"onUpdate:modelValue":r[3]||(r[3]=n=>d(e).sort=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});const oe={style:{display:"flex","margin-left":"12px"}},le=["href"],te={style:{margin:"10px 0 0 0"}},_e=N({__name:"hotGoodsConfig",setup(D){const s=I({tableData:[],totalCount:0,currentPage:1,pageSize:10}),i=p(),u=p("add"),_=p(3),e=p("");let C=p(!1);const k=p(),y=p([]),E=l=>{y.value=l};function f(){const l=M.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});g.get("indexConfigs",{params:{pageNumber:s.currentPage,pageSize:s.pageSize,configType:_.value}}).then(t=>{s.tableData=t.list,s.totalCount=t.totalCount,l.close()})}let c=function(l){C.value=!0,g.get("indexConfigs",{params:{pageNumber:l,pageSize:s.pageSize,configType:_.value}}).then(t=>{k.value.setScrollTop(0),s.tableData=t.list,s.totalCount=t.totalCount,C.value=!1})};const r=function(){new Promise((l,t)=>{u.value="add",l(void 0)}).then(()=>{i.value.open()})},b=function(){u.value="modify",Promise.resolve().then(()=>{i.value.open()})},v=function(l,t,n,V){console.log("hover进入获取单元格的id",l.configId,l),e.value=l.configId},x=function(l){let t=[];debugger;l==="all"?y.value.length===0?console.log("请选择需要批量删除的文件"):(t=y.value.map(n=>n.configId),g.delete("/indexConfigs/delete",{data:{ids:t}}).then(()=>{f()})):(t=[e.value],g.delete("/indexConfigs/delete",{data:{ids:t}}).then(()=>{f()}))};return P(()=>{f()}),q().beforeEach((l,t)=>{let n={sppz:3,xpsx:4,wntj:5};Object.keys(n).includes(l.name)&&(_.value=n[l.name],f())}),(l,t)=>{const n=B,V=Q,m=K,R=J,z=A,F=O;return S(),$(G,null,[T("div",oe,[o(n,{type:"primary",onClick:r},{default:a(()=>[h("新增")]),_:1}),o(V,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:t[0]||(t[0]=w=>x("all"))},{reference:a(()=>[o(n,{type:"danger"},{default:a(()=>[h("批量删除")]),_:1})]),_:1})]),j((S(),U(R,{ref_key:"multipleTableRef",ref:k,data:s.tableData,height:"500",style:{width:"100%"},onSelectionChange:E,onCellMouseEnter:v,"scroll-container":""},{default:a(()=>[o(m,{fixed:"",type:"selection",width:"55"}),o(m,{property:"configName",label:"商品名称",width:"120"}),o(m,{label:"跳转链接",width:"120"},{default:a(w=>[T("a",{target:"_blank",href:w.row.redirectUrl},L(w.row.redirectUrl),9,le)]),_:1}),o(m,{property:"configRank",label:"排序值",width:"120"}),o(m,{property:"configId",label:"商品编号",width:"120"}),o(m,{property:"createTime",label:"添加时间",width:"120"}),o(m,{label:"操作","show-overflow-tooltip":""},{default:a(()=>[o(V,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:t[1]||(t[1]=w=>x(""))},{reference:a(()=>[o(n,{link:"",type:"primary",size:"small"},{default:a(()=>[h("删除")]),_:1})]),_:1}),o(n,{link:"",type:"primary",size:"small",onClick:b},{default:a(()=>[h("修改")]),_:1})]),_:1})]),_:1},8,["data"])),[[F,d(C)]]),T("div",te,[o(z,{background:"",layout:"prev, pager, next",total:s.totalCount,onCurrentChange:d(c)},null,8,["total","onCurrentChange"])]),o(ee,{ref_key:"dialogSwi",ref:i,reload:f,type:u.value,id:e.value,configType:_.value},null,8,["type","id","configType"])],64)}}});export{_e as default};
